# ðŸŽ¯ RENDER DEPLOYMENT SETUP GUIDE

## ðŸ“‹ **PASOS PARA DEPLOYMENT EN RENDER**

### **Paso 1: Configurar Secrets en GitHub**

1. **Ir a GitHub Repository Settings:**
   ```
   GitHub Repo > Settings > Secrets and variables > Actions
   ```

2. **Agregar estos secrets:**
   ```bash
   # OBLIGATORIO - Para Docker automation
   DOCKERHUB_USERNAME=tu_usuario_dockerhub
   DOCKERHUB_TOKEN=dckr_pat_XXXXXXXXXXXXXXXXXXXXX
   
   # OPCIONAL - Para Render API automation
   RENDER_API_KEY=rnd_XXXXXXXXXXXXXXXX
   RENDER_SERVICE_ID=srv-XXXXXXXXXXXXX
   
   # BACKUP - Para Railway (inactivo por defecto)
   RAILWAY_TOKEN=XXXXXXXXXXXXX
   RAILWAY_SERVICE_ID=XXXXXXXXXXXXX
   ```

### **Paso 2: Crear Servicio en Render**

1. **Conectar GitHub:**
   - Ir a https://dashboard.render.com
   - New > Web Service
   - Connect GitHub repository: `frantastico-rgb/crud-mixto`

2. **Configurar Build Settings:**
   ```yaml
   Name: demomixto
   Environment: Docker
   Branch: main
   Root Directory: . (default)
   Dockerfile Path: ./Dockerfile
   ```

3. **Variables de Entorno en Render:**
   ```bash
   SPRING_PROFILES_ACTIVE=render
   PORT=8080
   ADMIN_USERNAME=admin
   ADMIN_PASSWORD=[Auto-generated by Render]
   MONGODB_URI=mongodb+srv://fullsena:Sena2025@servidorfull.87eqvrg.mongodb.net/empresa?retryWrites=true&w=majority&appName=SERVIDORFULL
   MAX_THREADS=10
   DB_POOL_SIZE=5
   ```

4. **Health Check:**
   ```
   Health Check Path: /actuator/health
   ```

### **Paso 3: Deploy Methods**

#### **OpciÃ³n A: Auto-Deploy (Recomendado)**
```bash
# 1. Push to main branch
git push origin main

# 2. GitHub Actions ejecuta workflow:
#    - Builds Docker image
#    - Pushes to DockerHub
#    - Render detecta cambios y redeploya automÃ¡ticamente
```

#### **OpciÃ³n B: Manual Deploy**
```bash
# Render Dashboard > Services > demomixto > Manual Deploy
```

#### **OpciÃ³n C: Render CLI**
```bash
# Install Render CLI
npm install -g @render/cli

# Deploy using render.yaml
render deploy
```

### **Paso 4: Verificar Deployment**

1. **Check Health:**
   ```bash
   curl https://demomixto.onrender.com/actuator/health
   ```

2. **Test API Endpoints:**
   ```bash
   # Proyectos (pÃºblico)
   curl https://demomixto.onrender.com/api/proyectos
   
   # Empleados (autenticado)
   curl -u admin:password https://demomixto.onrender.com/api/empleados
   ```

3. **Check Web Interface:**
   ```
   https://demomixto.onrender.com/proyectos
   https://demomixto.onrender.com/empleados
   ```

---

## ðŸ”„ **CI/CD WORKFLOW CON RENDER**

### **Flujo Automatizado:**

```mermaid
graph LR
    A[Git Push] --> B[GitHub Actions]
    B --> C[Run Tests]
    C --> D[Build Docker]
    D --> E[Push to DockerHub]
    E --> F[Render Auto-Deploy]
    F --> G[Live Application]
```

### **ConfiguraciÃ³n GitHub Actions:**

El workflow `ci-cd-unified.yml` ya estÃ¡ configurado para:

1. **Quick Tests:** En Pull Requests
2. **Comprehensive Tests:** En main branch
3. **Docker Build:** AutomÃ¡tico en main
4. **Render Deploy:** Via DockerHub image updates

---

## ðŸš„ **RAILWAY COMO BACKUP (INACTIVO)**

### **Estado Actual:**
- âœ… Railway profile configurado
- âœ… Deployment workflow preparado
- âš ï¸ **INACTIVO** por defecto

### **Activar Railway (solo si necesario):**
```bash
# 1. Commit con flag especial
git commit -m "deploy: activar Railway backup [deploy-railway]"

# 2. GitHub Actions detecta el flag y deploya a Railway
```

### **Configurar Railway Secrets:**
```bash
RAILWAY_TOKEN=tu_token_railway
RAILWAY_SERVICE_ID=tu_service_id
```

---

## ðŸ”§ **TROUBLESHOOTING COMÃšN**

### **Error: Render Build Failed**
```bash
SoluciÃ³n:
1. Verificar Dockerfile syntax
2. Check logs en Render Dashboard
3. Validate environment variables
```

### **Error: Health Check Failed**
```bash
SoluciÃ³n:
1. Verificar /actuator/health endpoint
2. Check MongoDB connection
3. Validate application.properties
```

### **Error: GitHub Actions Failed**
```bash
SoluciÃ³n:
1. Verificar DOCKERHUB_TOKEN vÃ¡lido
2. Check workflow permissions
3. Validate secrets configuration
```

---

## ðŸ“Š **MONITORING Y LOGS**

### **Render Dashboard:**
- Real-time logs
- Metrics y performance
- Deployment history
- Health status

### **Application Logs:**
```bash
# Via Render CLI
render logs -s demomixto

# Via Dashboard
Render > Services > demomixto > Logs
```

### **Health Monitoring:**
```bash
# Health endpoint
GET /actuator/health

# Application info  
GET /actuator/info
```